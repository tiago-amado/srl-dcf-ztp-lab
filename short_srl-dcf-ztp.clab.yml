name: srl-dcf-ztp
prefix: ""

topology:
  kinds:
    nokia_srlinux:
      image: ghcr.io/nokia/srlinux:23.10.3

  nodes:
    leaf1:
      kind: nokia_srlinux
      type: ixr-d2l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    leaf2:
      kind: nokia_srlinux
      type: ixr-d2l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh
 
    spine1:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
        #- ./certs/ca.pem:/ca.pem:rw   ## - Input file to originate CA
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    spine2:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

  links:
  # inter-switch links
    # leaf1 <-> spines
    - endpoints: ["leaf1:e1-48", "spine1:e1-1"]
    - endpoints: ["leaf1:e1-49", "spine2:e1-1"]
    # leaf2 <-> spines
    - endpoints: ["leaf2:e1-48", "spine1:e1-2"]
    - endpoints: ["leaf2:e1-49", "spine2:e1-2"]


