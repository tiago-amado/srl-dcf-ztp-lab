name: srl-dcf-ztp
prefix: ""

topology:
  kinds:
    nokia_srlinux:
      type: ixr-d2l
      image: ghcr.io/nokia/srlinux:23.10.3
    linux:
      image: ghcr.io/hellt/network-multitool

  nodes:
    leaf1:
      kind: nokia_srlinux
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    leaf2:
      kind: nokia_srlinux
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    leaf3:
      kind: nokia_srlinux
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    leaf4:
      kind: nokia_srlinux
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    spine1:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    spine2:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    spine3:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    spine4:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    border1:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh

    border2:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw ## - Configuration File
        - ./ndk/configurationless.sh:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh:rw ## - Executable File
        - ./ndk/configurationless.yang:/etc/opt/srlinux/appmgr/dcf-ztp/yang/configurationless.yang:rw ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/dcf-ztp/configurationless.py:rw ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/dcf-ztp/algorithms/nodesRolesAlgorithm.py:rw ## - Python Script:
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/dcf-ztp/
        - chmod +x /etc/opt/srlinux/appmgr/dcf-ztp/configurationless.sh
    #server11:
    #  kind: linux
    #  exec:
    #    - ip link set address 00:c1:ab:11:00:11 dev eth1
    #    - ip addr add 192.168.0.1/24 dev eth1
    #    - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    #server21:
    #  kind: linux
    #  exec:
    #    - ip link set address 00:c1:ab:11:00:21 dev eth1
    #    - ip addr add 192.168.0.1/24 dev eth1
    #    - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    #server22:
    #  kind: linux
    #  exec:
    #    - ip link set address 00:c1:ab:11:00:22 dev eth1
    #    - ip addr add 192.168.0.2/24 dev eth1
    #    - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    #server13:
    #  kind: linux
    #  exec:
    #    - ip link set address 00:c1:ab:11:00:13 dev eth1
    #    - ip addr add 192.168.0.3/24 dev eth1
    #    - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    #server23:
    #  kind: linux
    #  exec:
    #    - ip link set address 00:c1:ab:11:00:23 dev eth1
    #    - ip addr add 192.168.0.3/24 dev eth1
    #    - sysctl -w net.ipv6.conf.all.disable_ipv6=1

  links:
    # inter-switch links
    # leaf1 <-> spines
    - endpoints: [ "leaf1:e1-48", "spine1:e1-1" ]
    - endpoints: [ "leaf1:e1-49", "spine2:e1-1" ]
    # leaf2 <-> spines
    - endpoints: [ "leaf2:e1-48", "spine1:e1-2" ]
    - endpoints: [ "leaf2:e1-49", "spine2:e1-2" ]
    # leaf3 <-> spines
    - endpoints: [ "leaf3:e1-48", "spine3:e1-3" ]
    - endpoints: [ "leaf3:e1-49", "spine4:e1-3" ]
    # leaf3 <-> spines
    - endpoints: [ "leaf4:e1-48", "spine3:e1-4" ]
    - endpoints: [ "leaf4:e1-49", "spine4:e1-4" ]
    # spine1 <-> borders
    - endpoints: [ "spine1:e1-28", "border1:e1-1" ]
    - endpoints: [ "spine1:e1-29", "border2:e1-1" ]
    # spine1 <-> borders
    - endpoints: [ "spine2:e1-28", "border1:e1-2" ]
    - endpoints: [ "spine2:e1-29", "border2:e1-2" ]
    # spine1 <-> borders
    - endpoints: [ "spine3:e1-28", "border1:e1-3" ]
    - endpoints: [ "spine3:e1-29", "border2:e1-3" ]
    # spine1 <-> borders
    - endpoints: [ "spine4:e1-28", "border1:e1-4" ]
    - endpoints: [ "spine4:e1-29", "border2:e1-4" ]

    # server links
    #- endpoints: ["server11:eth1", "leaf1:e1-1"]
    #- endpoints: ["server21:eth1", "leaf1:e1-2"]
    #- endpoints: ["server22:eth1", "leaf2:e1-1"]
    #- endpoints: ["server13:eth1", "leaf3:e1-1"]
    #- endpoints: ["server23:eth1", "leaf3:e1-2"]
