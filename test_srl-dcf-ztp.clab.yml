name: srl-dcf-ztp
prefix: ""

topology:
  kinds:
    nokia_srlinux:
      image: ghcr.io/nokia/srlinux:23.10.1
    linux:
      image: ghcr.io/hellt/network-multitool

  nodes:
    leaf1:
      kind: nokia_srlinux
      type: ixr-d2l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.sh:/usr/local/bin/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
        - ./certs/ca.pem:/ca.pem:rw   ## - Input file to originate CA
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh

    spine1:
      kind: nokia_srlinux
      type: ixr-d3l
      binds:
        - ./plugin/show-fabric-plugin.py:/etc/opt/srlinux/cli/plugins/show-fabric-plugin.py:rw   ### CLI plugin show command
        - ./ndk/configurationless.sh:/usr/local/bin/configurationless.sh:rw   ## - Executable File
        - ./ndk/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw   ## - YANG Models
        - ./ndk/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw   ## - Configuration File
        - ./ndk/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw   ## - Python Script:
        - ./ndk/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw   ## - Python Script:
        - ./certs/ca.pem:/ca.pem:rw   ## - Input file to originate CA
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh


  links:
  # inter-switch links
    # leaf1 <-> spines
    - endpoints: ["leaf1:e1-48", "spine1:e1-1"]


